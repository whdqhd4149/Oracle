/*
  날짜 : 2025/07/18
  이름 : 이종봉
  내용 : SQL 연습문제1
*/

--실습 1-1
ALTER SESSION SET "_ORACLE_SCRIPT"=TRUE;
CREATE USER shop IDENTIFIED BY 1234;
GRANT CONNECT, RESOURCE, UNLIMITED TABLESPACE TO SHOP;
--실습 1-2
DROP TABLE PRODUCT;
create table customer (
    CID        VARCHAR2(20) PRIMARY KEY,
    NAME       VARCHAR2(20) NOT NULL,
    HP         CHAR(13) UNIQUE,
    ADDRESS    VARCHAR2(200),
    RDATE      DATE NOT NULL
);
create table product(
    pno      NUMBER(4) PRIMARY KEY,
    PNAME    VARCHAR2(30) NOT NULL,
    STOCK    NUMBER DEFAULT 0,
    PRICE    NUMBER,
    COMPANY  VARCHAR2(20)
);
create table orders(
    ORD_NO   NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ORD_CID  VARCHAR2(20) NOT NULL,
    ORD_PNO  NUMBER(4) NOT NULL,
    ORD_CNT  NUMBER DEFAULT 1,
    ORD_DATE DATE NOT NULL
);
--실습 1-3
INSERT INTO CUSTOMER VALUES ('C101', '김유신', '010-1234-1001', '김해시 봉황동', '2022-01-01');
INSERT INTO CUSTOMER VALUES ('C102', '김춘추', '010-1234-1002', '경주시 보문동', '2022-01-02');
INSERT INTO CUSTOMER VALUES ('C103', '장보고', '010-1234-1003', '완도군 청산면', '2022-01-03');
INSERT INTO CUSTOMER VALUES ('C104', '강감찬', '010-1234-1004', '서울시 마포구', '2022-01-04');
INSERT INTO CUSTOMER VALUES ('C105', '이성계', NULL, NULL, '2022-01-05');
INSERT INTO CUSTOMER VALUES ('C106', '정철', '010-1234-1006', '경기도 용인시', '2022-01-06');
INSERT INTO CUSTOMER VALUES ('C107', '허준', NULL, NULL, '2022-01-07');
INSERT INTO CUSTOMER VALUES ('C108', '이순신', '010-1234-1008', '서울시 영등포구', '2022-01-08');
INSERT INTO CUSTOMER VALUES ('C109', '송상현', '010-1234-1009', '부산시 동래구', '2022-01-09');
INSERT INTO CUSTOMER VALUES ('C110', '정약용', '010-1234-1010', '경기도 광주시', '2022-01-10');

INSERT INTO PRODUCT VALUES (1, '새우깡', 5000, 1500, '농심');
INSERT INTO PRODUCT VALUES (2, '초코파이', 2500, 2500, '오리온');
INSERT INTO PRODUCT VALUES (3, '포카칩', 3600, 1700, '오리온');
INSERT INTO PRODUCT VALUES (4, '양파링', 1250, 1800, '농심');
INSERT INTO PRODUCT VALUES (5, '죠리퐁', 2200, NULL, '크라운');
INSERT INTO PRODUCT VALUES (6, '마가렛트', 3500, 3500, '롯데');
INSERT INTO PRODUCT VALUES (7, '뿌셔뿌셔', 1650, 1200, '오뚜기');

INSERT INTO ORDERS(ord_cid, ord_pno, ord_cnt, ord_date) VALUES ('C102', 3, 2, '2022-07-01 13:15:10');
INSERT INTO ORDERS(ord_cid, ord_pno, ord_cnt, ord_date) VALUES ('C101', 4, 1, '2022-07-01 14:16:11');
INSERT INTO ORDERS(ord_cid, ord_pno, ord_cnt, ord_date) VALUES ('C108', 1, 1, '2022-07-01 17:23:18');
INSERT INTO ORDERS(ord_cid, ord_pno, ord_cnt, ord_date) VALUES ('C109', 6, 5, '2022-07-02 10:46:36');
INSERT INTO ORDERS(ord_cid, ord_pno, ord_cnt, ord_date) VALUES ('C102', 2, 1, '2022-07-03 09:15:37');
INSERT INTO ORDERS(ord_cid, ord_pno, ord_cnt, ord_date) VALUES ('C101', 7, 3, '2022-07-03 12:35:12');
INSERT INTO ORDERS(ord_cid, ord_pno, ord_cnt, ord_date) VALUES ('C110', 1, 2, '2022-07-03 16:55:36');
INSERT INTO ORDERS(ord_cid, ord_pno, ord_cnt, ord_date) VALUES ('C104', 2, 4, '2022-07-04 14:23:23');
INSERT INTO ORDERS(ord_cid, ord_pno, ord_cnt, ord_date) VALUES ('C102', 1, 3, '2022-07-04 21:54:34');
INSERT INTO ORDERS(ord_cid, ord_pno, ord_cnt, ord_date) VALUES ('C107', 6, 1, '2022-07-05 14:21:03');
--실습 1-4
SELECT * FROM CUSTOMER;
--실습 1-5
SELECT CID, NAME, HP FROM CUSTOMER;
--실습 1-6
SELECT * FROM PRODUCT;
--실습 1-7
SELECT COMPANY FROM PRODUCT;
--실습 1-8
SELECT DISTINCT COMPANY FROM PRODUCT;
--실습 1-9
SELECT PNAME, PRICE FROM PRODUCT;
--실습 1-10
SELECT PNAME, PRICE + 500 AS 조정단가 FROM PRODUCT;
--실습 1-11
SELECT PNAME, STOCK, PRICE FROM PRODUCT WHERE COMPANY='오리온';
--실습 1-12
SELECT ORD_PNO, ORD_CNT, ORD_DATE FROM ORDERS WHERE ORD_CID='C102';
--실습 1-13
SELECT ORD_PNO, ORD_CNT, ORD_DATE FROM ORDERS WHERE ORD_CID='C102' AND ORD_CNT>=2;
--실습 1-14
SELECT * FROM PRODUCT WHERE PRICE >=1000 AND PRICE <=2000;
--실습 1-15
SELECT CID, NAME, HP, ADDRESS FROM CUSTOMER WHERE NAME LIKE '김%';
--실습 1-16
SELECT CID, NAME, HP, ADDRESS FROM CUSTOMER WHERE NAME LIKE '__';
--실습 1-17
SELECT * FROM CUSTOMER WHERE HP IS NULL;
--실습 1-18
SELECT * FROM CUSTOMER WHERE ADDRESS IS NOT NULL;
--실습 1-19
SELECT * FROM CUSTOMER ORDER BY RDATE DESC;
--실습 1-20
SELECT * FROM ORDERS 
WHERE ORD_CNT >= 3 ORDER BY ORD_CNT DESC, ORD_PNO ASC;
--실습 1-21
SELECT AVG(PRICE)FROM PRODUCT;
--실습 1-22
SELECT SUM(STOCK)FROM PRODUCT WHERE COMPANY='농심';
--실습 1-23
SELECT COUNT(*) AS 고객수 FROM CUSTOMER;
--실습 1-24
SELECT COUNT(DISTINCT COMPANY) AS "제조업체 수" FROM PRODUCT;
--실습 1-25
SELECT ORD_PNO AS "주문 상품번호", 
SUM(ORD_CNT) AS "총 주문수량" FROM ORDERS GROUP BY ORD_PNO ORDER BY ORD_PNO ASC;
--실습 1-26
SELECT COMPANY AS 제조업체, COUNT(*)AS 제품수, MAX(PRICE) AS 최고가 FROM PRODUCT
GROUP BY COMPANY ORDER BY COMPANY ASC;
--실습 1-27
SELECT COMPANY AS 제조업체, COUNT(*)AS 제품수, MAX(PRICE)AS 최고가 FROM PRODUCT
GROUP BY COMPANY HAVING COUNT(*)>=2;
--실습 1-28
SELECT ORD_PNO, ORD_CID, SUM(ORD_CNT)AS "총 주문수량" FROM ORDERS
GROUP BY ORD_PNO, ORD_CID ORDER BY ORD_PNO;
--실습 1-29
SELECT ORD_CID, PNAME FROM ORDERS A 
JOIN PRODUCT B
ON A.ORD_PNO = B.PNO
WHERE ORD_CID = 'C102';
--실습 1-30
SELECT ORD_CID, NAME, PNAME, ORD_DATE FROM ORDERS A
JOIN CUSTOMER B ON A.ORD_CID = B.CID
JOIN PRODUCT C ON A.ORD_PNO = C.PNO
WHERE ORD_DATE LIKE '2022-07-03%'
